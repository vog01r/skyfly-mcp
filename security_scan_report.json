{
  "summary": {
    "total_issues": 33,
    "critical": 5,
    "high": 2,
    "medium": 26,
    "low": 0
  },
  "by_category": {
    "security": 10,
    "bugs": 0,
    "performance": 0,
    "architecture": 23
  },
  "issues": [
    {
      "severity": "HIGH",
      "category": "SECURITY",
      "file": "/workspace/opensky_client.py",
      "line": 158,
      "description": "Exception may expose sensitive information via f-string",
      "code": "raise Exception(f\"API request failed with status {response.status_code}: {response.text}\")",
      "fix": ""
    },
    {
      "severity": "HIGH",
      "category": "SECURITY",
      "file": "/workspace/opensky_client.py",
      "line": 162,
      "description": "Exception may expose sensitive information via f-string",
      "code": "raise Exception(f\"Request error: {str(e)}\")",
      "fix": ""
    },
    {
      "severity": "CRITICAL",
      "category": "SECURITY",
      "file": "/workspace/security_scanner.py",
      "line": 99,
      "description": "Use of eval() can lead to code injection",
      "code": "'description': 'Use of eval() can lead to code injection'",
      "fix": ""
    },
    {
      "severity": "CRITICAL",
      "category": "SECURITY",
      "file": "/workspace/security_scanner.py",
      "line": 104,
      "description": "Use of exec() can lead to code injection",
      "code": "'description': 'Use of exec() can lead to code injection'",
      "fix": ""
    },
    {
      "severity": "MEDIUM",
      "category": "ARCHITECTURE",
      "file": "/workspace/security_scanner.py",
      "line": 121,
      "description": "Unresolved technical debt comment",
      "code": "# TODO/FIXME non trait√©s",
      "fix": ""
    },
    {
      "severity": "MEDIUM",
      "category": "ARCHITECTURE",
      "file": "/workspace/security_scanner.py",
      "line": 409,
      "description": "Function may be too long",
      "code": "def main():",
      "fix": ""
    },
    {
      "severity": "MEDIUM",
      "category": "ARCHITECTURE",
      "file": "/workspace/security_scanner.py",
      "line": 39,
      "description": "Function \"__init__\" is 95 lines long (>50)",
      "code": "def __init__(...): # 95 lines",
      "fix": ""
    },
    {
      "severity": "MEDIUM",
      "category": "ARCHITECTURE",
      "file": "/workspace/security_scanner.py",
      "line": 178,
      "description": "Function \"_scan_with_ast\" is 69 lines long (>50)",
      "code": "def _scan_with_ast(...): # 69 lines",
      "fix": ""
    },
    {
      "severity": "MEDIUM",
      "category": "ARCHITECTURE",
      "file": "/workspace/security_scanner.py",
      "line": 178,
      "description": "Function \"_scan_with_ast\" has high complexity (12)",
      "code": "def _scan_with_ast(...): # complexity: 12",
      "fix": ""
    },
    {
      "severity": "MEDIUM",
      "category": "ARCHITECTURE",
      "file": "/workspace/security_scanner.py",
      "line": 409,
      "description": "Function \"main\" is 55 lines long (>50)",
      "code": "def main(...): # 55 lines",
      "fix": ""
    },
    {
      "severity": "MEDIUM",
      "category": "ARCHITECTURE",
      "file": "/workspace/server.py",
      "line": 26,
      "description": "Function may be too long",
      "code": "def get_current_time() -> int:",
      "fix": ""
    },
    {
      "severity": "MEDIUM",
      "category": "ARCHITECTURE",
      "file": "/workspace/aircraftdb/tools.py",
      "line": 53,
      "description": "Function may be too long",
      "code": "def get_aircraftdb_tools() -> List[Tool]:",
      "fix": ""
    },
    {
      "severity": "MEDIUM",
      "category": "ARCHITECTURE",
      "file": "/workspace/aircraftdb/tools.py",
      "line": 53,
      "description": "Function \"get_aircraftdb_tools\" is 227 lines long (>50)",
      "code": "def get_aircraftdb_tools(...): # 227 lines",
      "fix": ""
    },
    {
      "severity": "CRITICAL",
      "category": "SECURITY",
      "file": "/workspace/aircraftdb/database.py",
      "line": 259,
      "description": "Potential SQL injection via f-string",
      "code": "rows = conn.execute(f\"\"\"",
      "fix": ""
    },
    {
      "severity": "CRITICAL",
      "category": "SECURITY",
      "file": "/workspace/aircraftdb/database.py",
      "line": 434,
      "description": "Potential SQL injection via f-string",
      "code": "rows = conn.execute(f\"\"\"",
      "fix": ""
    },
    {
      "severity": "CRITICAL",
      "category": "SECURITY",
      "file": "/workspace/aircraftdb/database.py",
      "line": 498,
      "description": "Potential SQL injection via f-string",
      "code": "row = conn.execute(f\"SELECT COUNT(*) as count FROM {table}\").fetchone()",
      "fix": ""
    },
    {
      "severity": "MEDIUM",
      "category": "ARCHITECTURE",
      "file": "/workspace/aircraftdb/database.py",
      "line": 516,
      "description": "Function may be too long",
      "code": "def get_database() -> AircraftDatabase:",
      "fix": ""
    },
    {
      "severity": "MEDIUM",
      "category": "ARCHITECTURE",
      "file": "/workspace/aircraftdb/database.py",
      "line": 47,
      "description": "Function \"_init_schema\" is 131 lines long (>50)",
      "code": "def _init_schema(...): # 131 lines",
      "fix": ""
    },
    {
      "severity": "MEDIUM",
      "category": "ARCHITECTURE",
      "file": "/workspace/aircraftdb/database.py",
      "line": 304,
      "description": "Function \"upsert_aircraft_registry\" is 75 lines long (>50)",
      "code": "def upsert_aircraft_registry(...): # 75 lines",
      "fix": ""
    },
    {
      "severity": "MEDIUM",
      "category": "ARCHITECTURE",
      "file": "/workspace/aircraftdb/ingest.py",
      "line": 90,
      "description": "Function may be too long",
      "code": "def normalize_column_name(name: str) -> str:",
      "fix": ""
    },
    {
      "severity": "MEDIUM",
      "category": "ARCHITECTURE",
      "file": "/workspace/aircraftdb/ingest.py",
      "line": 105,
      "description": "Function may be too long",
      "code": "def parse_int(value: str) -> Optional[int]:",
      "fix": ""
    },
    {
      "severity": "MEDIUM",
      "category": "ARCHITECTURE",
      "file": "/workspace/aircraftdb/ingest.py",
      "line": 118,
      "description": "Function may be too long",
      "code": "def parse_value(value: str) -> Any:",
      "fix": ""
    },
    {
      "severity": "MEDIUM",
      "category": "ARCHITECTURE",
      "file": "/workspace/aircraftdb/ingest.py",
      "line": 141,
      "description": "Function may be too long",
      "code": "def detect_encoding(file_path: Path) -> str:",
      "fix": ""
    },
    {
      "severity": "MEDIUM",
      "category": "ARCHITECTURE",
      "file": "/workspace/aircraftdb/ingest.py",
      "line": 157,
      "description": "Function may be too long",
      "code": "def parse_faa_csv(file_path: Path, column_mapping: Dict[str, str]) -> Generator[Dict[str, Any], None, None]:",
      "fix": ""
    },
    {
      "severity": "MEDIUM",
      "category": "ARCHITECTURE",
      "file": "/workspace/aircraftdb/ingest.py",
      "line": 303,
      "description": "Function may be too long",
      "code": "def ingest_xlsx(file_path: Path, database) -> Dict[str, int]:",
      "fix": ""
    },
    {
      "severity": "MEDIUM",
      "category": "ARCHITECTURE",
      "file": "/workspace/aircraftdb/ingest.py",
      "line": 355,
      "description": "Function may be too long",
      "code": "def ingest_json(file_path: Path, database) -> Dict[str, int]:",
      "fix": ""
    },
    {
      "severity": "MEDIUM",
      "category": "ARCHITECTURE",
      "file": "/workspace/aircraftdb/ingest.py",
      "line": 386,
      "description": "Function may be too long",
      "code": "def ingest_directory(data_dir: Path, database) -> Dict[str, Any]:",
      "fix": ""
    },
    {
      "severity": "MEDIUM",
      "category": "ARCHITECTURE",
      "file": "/workspace/aircraftdb/ingest.py",
      "line": 303,
      "description": "Function \"ingest_xlsx\" has high complexity (13)",
      "code": "def ingest_xlsx(...): # complexity: 13",
      "fix": ""
    },
    {
      "severity": "MEDIUM",
      "category": "ARCHITECTURE",
      "file": "/workspace/aircraftdb/ingest.py",
      "line": 386,
      "description": "Function \"ingest_directory\" is 86 lines long (>50)",
      "code": "def ingest_directory(...): # 86 lines",
      "fix": ""
    },
    {
      "severity": "MEDIUM",
      "category": "ARCHITECTURE",
      "file": "/workspace/aircraftdb/ingest.py",
      "line": 386,
      "description": "Function \"ingest_directory\" has high complexity (15)",
      "code": "def ingest_directory(...): # complexity: 15",
      "fix": ""
    },
    {
      "severity": "MEDIUM",
      "category": "SECURITY",
      "file": "requirements.txt",
      "line": 1,
      "description": "Package pyyaml version 6.0.1 may have known vulnerabilities",
      "code": "",
      "fix": ""
    },
    {
      "severity": "MEDIUM",
      "category": "SECURITY",
      "file": "requirements.txt",
      "line": 1,
      "description": "Package requests version 2.32.5 may have known vulnerabilities",
      "code": "",
      "fix": ""
    },
    {
      "severity": "MEDIUM",
      "category": "SECURITY",
      "file": "requirements.txt",
      "line": 1,
      "description": "Package urllib3 version 2.6.2 may have known vulnerabilities",
      "code": "",
      "fix": ""
    }
  ],
  "recommendations": [
    "üö® 5 probl√®mes CRITIQUES n√©cessitent une attention imm√©diate",
    "üîê 10 probl√®mes de s√©curit√© d√©tect√©s",
    "Impl√©menter une validation stricte des requ√™tes SQL"
  ]
}